\AgdaHide{
\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{Prelims.Closure} \AgdaKeyword{where}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{sym}\AgdaSymbol{;}\AgdaFunction{trans}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality.Core}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary}\<%
\\
%
\\
\>\AgdaFunction{Relation} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaSymbol{→} \AgdaPrimitiveType{Set₁}\<%
\\
\>\AgdaFunction{Relation} \AgdaBound{A} \AgdaSymbol{=} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{RClose} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{inc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ref} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{x}\<%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{TClose} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{inc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{TClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{TClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{TClose} \AgdaBound{R} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{→} \AgdaDatatype{TClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{z}\<%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{RTClose} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{inc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ref} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{z}\<%
\\
%
\\
\>\AgdaFunction{RTCLOSE} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{Relation} \AgdaBound{A} \AgdaSymbol{→} \AgdaRecord{Preorder} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_}\<%
\\
\>\AgdaFunction{RTCLOSE} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{R} \AgdaSymbol{=} \AgdaKeyword{record} \AgdaSymbol{\{} \<[25]%
\>[25]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaField{Carrier} \AgdaSymbol{=} \AgdaBound{A} \AgdaSymbol{;} \<[16]%
\>[16]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaField{\_≈\_} \AgdaSymbol{=} \AgdaDatatype{\_≡\_} \AgdaSymbol{;} \<[14]%
\>[14]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaField{\_∼\_} \AgdaSymbol{=} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaSymbol{;} \<[20]%
\>[20]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaField{isPreorder} \AgdaSymbol{=} \AgdaKeyword{record} \AgdaSymbol{\{} \<[24]%
\>[24]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaField{isEquivalence} \AgdaSymbol{=} \AgdaFunction{Relation.Binary.PropositionalEquality.Core.isEquivalence} \AgdaSymbol{;} \<[79]%
\>[79]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaField{reflexive} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{.\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaInductiveConstructor{refl} \AgdaSymbol{→} \AgdaInductiveConstructor{ref} \AgdaSymbol{\}} \AgdaSymbol{;} \<[44]%
\>[44]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaField{trans} \AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{\}} \AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{R-sub-RT} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{R}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RClose} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaFunction{R-sub-RT} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{xRy}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inc} \AgdaBound{xRy}\<%
\\
\>\AgdaFunction{R-sub-RT} \AgdaInductiveConstructor{ref} \AgdaSymbol{=} \AgdaInductiveConstructor{ref}\<%
\\
%
\\
\>\AgdaFunction{T-sub-RT} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{R}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{TClose} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaFunction{T-sub-RT} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{xRy}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inc} \AgdaBound{xRy}\<%
\\
\>\AgdaFunction{T-sub-RT} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{xRy} \AgdaBound{yRz}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{T-sub-RT} \AgdaBound{xRy}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{T-sub-RT} \AgdaBound{yRz}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{RSTClose} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaFunction{Relation} \AgdaBound{A} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{inc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ref} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{sym} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{y} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{z}\<%
\\
%
\\
\>\AgdaFunction{RT-sub-RST} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{RTClose} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{→} \AgdaDatatype{RSTClose} \AgdaBound{R} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaFunction{RT-sub-RST} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{xRy}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inc} \AgdaBound{xRy}\<%
\\
\>\AgdaFunction{RT-sub-RST} \AgdaInductiveConstructor{ref} \AgdaSymbol{=} \AgdaInductiveConstructor{ref}\<%
\\
\>\AgdaFunction{RT-sub-RST} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{xRTy} \AgdaBound{yRTz}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{RT-sub-RST} \AgdaBound{xRTy}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{RT-sub-RST} \AgdaBound{yRTz}\AgdaSymbol{)}\<%
\end{code}
}
