\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{PHOPL.SN} \AgdaKeyword{where}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Empty} \AgdaKeyword{renaming} \AgdaSymbol{(}\AgdaDatatype{⊥} \AgdaSymbol{to} \AgdaDatatype{Empty}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Prelims.Closure}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{PHOPL.Grammar}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{PHOPL.Red}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Reduction.Botsub} \AgdaFunction{PHOPL} \AgdaDatatype{R}\<%
\\
%
\\
\>\AgdaKeyword{private} \AgdaFunction{βR-exp'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{φ} \AgdaSymbol{:} \AgdaFunction{Term} \AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{δ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ε}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{χ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{φ} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{δ} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{ε} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaDatatype{SN} \AgdaSymbol{(}\AgdaBound{δ} \AgdaFunction{⟦} \AgdaFunction{x₀:=} \AgdaBound{ε} \AgdaFunction{⟧}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{appP} \AgdaSymbol{(}\AgdaFunction{ΛP} \AgdaBound{φ} \AgdaBound{δ}\AgdaSymbol{)} \AgdaBound{ε} \AgdaDatatype{⇒} \AgdaBound{χ} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{χ}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{redex} \AgdaSymbol{(}\AgdaInductiveConstructor{βR} \AgdaSymbol{\_} \AgdaSymbol{\_))} \AgdaSymbol{=} \AgdaBound{SNδε}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{redex} \AgdaSymbol{())))}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaBound{φ} \AgdaBound{SNφ}\AgdaSymbol{)} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{φ⇒φ'}\AgdaSymbol{))))} \AgdaSymbol{=} \<[66]%
\>[66]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βR-exp'} \AgdaSymbol{(}\AgdaBound{SNφ} \AgdaSymbol{\_} \AgdaBound{φ⇒φ'}\AgdaSymbol{)} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε}\AgdaSymbol{)} \<[50]%
\>[50]\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaBound{δ} \AgdaBound{SNδ}\AgdaSymbol{)} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{δ⇒δ'}\AgdaSymbol{)))))} \AgdaSymbol{=} \<[73]%
\>[73]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaSymbol{(}\AgdaBound{SNδ} \AgdaSymbol{\_} \AgdaBound{δ⇒δ'}\AgdaSymbol{)} \AgdaBound{SNε} \AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaFunction{apredr} \AgdaFunction{SUB} \AgdaPostulate{R-respects-sub} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{δ⇒δ'}\AgdaSymbol{))))}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{())))))}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaSymbol{\{}\AgdaArgument{δ} \AgdaSymbol{=} \AgdaBound{δ}\AgdaSymbol{\}} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaBound{ε} \AgdaBound{SNε}\AgdaSymbol{)} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{ε⇒ε'}\AgdaSymbol{)))} \AgdaSymbol{=} \<[68]%
\>[68]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaSymbol{(}\AgdaBound{SNε} \AgdaSymbol{\_} \AgdaBound{ε⇒ε'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaFunction{apredl} \AgdaFunction{SUB} \AgdaSymbol{\{}\AgdaArgument{E} \AgdaSymbol{=} \AgdaBound{δ}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \AgdaSymbol{(}\AgdaFunction{botsub-red} \AgdaBound{ε⇒ε'}\AgdaSymbol{))))}\<%
\\
\>\AgdaFunction{βR-exp'} \AgdaBound{SNφ} \AgdaBound{SNδ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{())))}\<%
\\
%
\\
\>\AgdaFunction{βR-exp} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{φ} \AgdaSymbol{:} \AgdaFunction{Term} \AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{δ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ε}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{φ} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{ε} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaDatatype{SN} \AgdaSymbol{(}\AgdaBound{δ} \AgdaFunction{⟦} \AgdaFunction{x₀:=} \AgdaBound{ε} \AgdaFunction{⟧}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaSymbol{(}\AgdaFunction{appP} \AgdaSymbol{(}\AgdaFunction{ΛP} \AgdaBound{φ} \AgdaBound{δ}\AgdaSymbol{)} \AgdaBound{ε}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{βR-exp} \AgdaSymbol{\{}\AgdaArgument{φ} \AgdaSymbol{=} \AgdaBound{φ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{δ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ε}\AgdaSymbol{\}} \AgdaBound{SNφ} \AgdaBound{SNε} \AgdaBound{SNδε} \AgdaSymbol{=} \AgdaInductiveConstructor{SNI} \AgdaSymbol{(}\AgdaFunction{appP} \AgdaSymbol{(}\AgdaFunction{ΛP} \AgdaBound{φ} \AgdaBound{δ}\AgdaSymbol{)} \AgdaBound{ε}\AgdaSymbol{)} \AgdaSymbol{(λ} \AgdaBound{χ} \AgdaSymbol{→} \AgdaFunction{βR-exp'} \AgdaBound{SNφ} \<[79]%
\>[79]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{SNap'} \AgdaSymbol{\{}\AgdaArgument{Ops} \AgdaSymbol{=} \AgdaFunction{SUB}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \AgdaBound{SNδε}\AgdaSymbol{)} \AgdaBound{SNε} \AgdaBound{SNδε}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{private} \AgdaFunction{βE-exp'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{Term} \AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{Q}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{R}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaDatatype{SN} \AgdaBound{M} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{N} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{P} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{Q} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaDatatype{SN} \AgdaSymbol{(}\AgdaBound{P} \AgdaFunction{⟦} \AgdaFunction{x₂:=} \AgdaBound{M} \AgdaFunction{,x₁:=} \AgdaBound{N} \AgdaFunction{,x₀:=} \AgdaBound{Q} \AgdaFunction{⟧}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaFunction{app*} \AgdaBound{M} \AgdaBound{N} \AgdaSymbol{(}\AgdaFunction{λλλ} \AgdaBound{A} \AgdaBound{P}\AgdaSymbol{)} \AgdaBound{Q} \AgdaDatatype{⇒} \AgdaBound{R} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaDatatype{SN} \AgdaBound{R}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{redex} \AgdaSymbol{(}\AgdaInductiveConstructor{βE} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_))} \AgdaSymbol{=} \AgdaBound{SNPMNQ}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaSymbol{\{}\AgdaArgument{P} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaBound{M} \AgdaBound{SNM}\AgdaSymbol{)} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{M⇒M'}\AgdaSymbol{))} \AgdaSymbol{=} \<[67]%
\>[67]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βE-exp'} \AgdaSymbol{(}\AgdaBound{SNM} \AgdaSymbol{\_} \AgdaBound{M⇒M'}\AgdaSymbol{)} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \<[48]%
\>[48]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaFunction{apredl} \AgdaFunction{SUB} \AgdaSymbol{\{}\AgdaArgument{E} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \<[53]%
\>[53]\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{botsub₃-red} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{M⇒M'}\AgdaSymbol{)} \AgdaInductiveConstructor{ref} \AgdaInductiveConstructor{ref}\AgdaSymbol{))))} \<[42]%
\>[42]\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaSymbol{\{}\AgdaArgument{P} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaBound{SNM} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaBound{SNN}\AgdaSymbol{)} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{N⇒N'}\AgdaSymbol{)))} \AgdaSymbol{=} \<[74]%
\>[74]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaSymbol{(}\AgdaBound{SNN} \AgdaSymbol{\_} \AgdaBound{N⇒N'}\AgdaSymbol{)} \AgdaBound{SNP} \AgdaBound{SNQ} \<[48]%
\>[48]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaFunction{apredl} \AgdaFunction{SUB} \AgdaSymbol{\{}\AgdaArgument{E} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \<[53]%
\>[53]\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{botsub₃-red} \AgdaInductiveConstructor{ref} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{N⇒N'}\AgdaSymbol{)} \AgdaInductiveConstructor{ref}\AgdaSymbol{))))}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{redex} \AgdaSymbol{())))))}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaBound{SNP}\AgdaSymbol{)} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{P⇒P'}\AgdaSymbol{))))))} \AgdaSymbol{=} \<[86]%
\>[86]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaSymbol{(}\AgdaBound{SNP} \AgdaSymbol{\_} \AgdaBound{P⇒P'}\AgdaSymbol{)} \AgdaBound{SNQ}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaFunction{apredr} \AgdaFunction{SUB} \AgdaPostulate{R-respects-sub} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{P⇒P'}\AgdaSymbol{))))}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{()))))))}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaSymbol{\{}\AgdaArgument{P} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaSymbol{(}\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaBound{SNQ}\AgdaSymbol{)} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appl} \AgdaBound{Q⇒Q'}\AgdaSymbol{)))))} \AgdaSymbol{=} \<[88]%
\>[88]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaSymbol{(}\AgdaBound{SNQ} \AgdaSymbol{\_} \AgdaBound{Q⇒Q'}\AgdaSymbol{)} \<[48]%
\>[48]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{SNred} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaFunction{apredl} \AgdaFunction{SUB} \AgdaSymbol{\{}\AgdaArgument{E} \AgdaSymbol{=} \AgdaBound{P}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \<[53]%
\>[53]\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{botsub₃-red} \AgdaInductiveConstructor{ref} \AgdaInductiveConstructor{ref} \AgdaSymbol{(}\AgdaInductiveConstructor{inc} \AgdaBound{Q⇒Q'}\AgdaSymbol{)))))}\<%
\\
\>\AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNP} \AgdaBound{SNQ} \AgdaBound{SNPMNQ} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{(}\AgdaInductiveConstructor{appr} \AgdaSymbol{())))))}\<%
\\
%
\\
\>\AgdaFunction{βE-exp} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{Term} \AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{Q}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaDatatype{SN} \AgdaBound{M} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{N} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaBound{Q} \AgdaSymbol{→}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaDatatype{SN} \AgdaSymbol{(}\AgdaBound{P} \AgdaFunction{⟦} \AgdaFunction{x₂:=} \AgdaBound{M} \AgdaFunction{,x₁:=} \AgdaBound{N} \AgdaFunction{,x₀:=} \AgdaBound{Q} \AgdaFunction{⟧}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaDatatype{SN} \AgdaSymbol{(}\AgdaFunction{app*} \AgdaBound{M} \AgdaBound{N} \AgdaSymbol{(}\AgdaFunction{λλλ} \AgdaBound{A} \AgdaBound{P}\AgdaSymbol{)} \AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{βE-exp} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaBound{SNQ} \AgdaBound{SNPQ} \AgdaSymbol{=} \AgdaInductiveConstructor{SNI} \AgdaSymbol{\_} \AgdaSymbol{(λ} \AgdaBound{R} \AgdaBound{PQ⇒R} \AgdaSymbol{→} \AgdaFunction{βE-exp'} \AgdaBound{SNM} \AgdaBound{SNN} \AgdaSymbol{(}\AgdaFunction{SNap'} \AgdaSymbol{\{}\AgdaArgument{Ops} \AgdaSymbol{=} \AgdaFunction{SUB}\AgdaSymbol{\}} \AgdaPostulate{R-respects-sub} \AgdaBound{SNPQ}\AgdaSymbol{)} \AgdaBound{SNQ} \AgdaBound{SNPQ} \AgdaBound{PQ⇒R}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaComment{--REFACTOR Common pattern}\<%
\\
%
\\
\>\AgdaKeyword{private} \AgdaFunction{SN'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{φ} \AgdaSymbol{:} \AgdaFunction{Term} \AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{⊥} \AgdaDatatype{⇒} \AgdaBound{φ} \AgdaSymbol{→} \AgdaDatatype{Empty}\<%
\\
\>\AgdaFunction{SN'} \AgdaSymbol{(}\AgdaInductiveConstructor{redex} \AgdaSymbol{())}\<%
\\
\>\AgdaFunction{SN'} \AgdaSymbol{(}\AgdaInductiveConstructor{app} \AgdaSymbol{())}\<%
\\
%
\\
\>\AgdaFunction{SN⊥} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SN} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaFunction{⊥}\<%
\\
\>\AgdaFunction{SN⊥} \AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaInductiveConstructor{SNI} \AgdaFunction{⊥} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaBound{⊥⇒F} \AgdaSymbol{→} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaFunction{SN'} \AgdaBound{⊥⇒F}\AgdaSymbol{))}\<%
\end{code}
